openapi: 3.0.3
info:
  version: '3.0'
  title: Fyle REST API
  contact:
    name: Integrations
    email: support@fyle.in
servers:
  - url: 'https://accounts.fylehq.com'
    description: Live Server
components:
  securitySchemes:
    oauth2:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: 'https://accounts.fylehq.com/app/developers/#/oauth/authorize'
          tokenUrl: 'https://accounts.fylehq.com/oauth/token'
          scopes:
            common.*: Grant all COMMON actions
  parameters:
    text:
      in: query
      name: q
      required: true
      description: >
        The query string on which to search. The service will return candidate
        matches based on this string and order results based on their perceived
        relevance.<br>

        text=bangalore
      schema:
        type: string
        example: bangalore
    types:
      in: query
      name: type
      required: true
      description: |
        This param will define the types of place results to return.<br>
        types=(cities)
      schema:
        type: string
        example: (cities)
    cordinates:
      in: query
      name: location
      description: >
        This param specifies the point around which you wish to retrieve place
        information.<br>

        location=latitude,longitude
      schema:
        type: string
        example: '26.595889,85.4891037'
  schemas:
    '401':
      type: object
      properties:
        message:
          enum:
            - invalid token
          type: string
          description: >
            This error means that the input access token is either not issued by
            Fyle or has expired.

            You need to generate a new access token.
    '403':
      type: object
      properties:
        message:
          enum:
            - Forbidden
          type: string
          description: >
            This error means current user does not have enough permissions to
            perform this operation.
    count:
      description: |
        The total number of objects that can be requested.
      type: integer
      example: 10000
    places:
      type: array
      items:
        type: object
        properties:
          formatted_address:
            type: string
            maxLength: 255
            description: |
              Contains the human-readable name for the returned result.
            readOnly: true
            example: 'Andheri, Maharashtra, India'
          place_id:
            type: string
            maxLength: 255
            description: >-
              It containes a textual identifier that uniquely identifies a
              place.
            example: ChIJify3BTzI5zsR2q86fwXrh74
          reference:
            type: string
            maxLength: 255
            description: Contains reference id for the particular location.
            example: ChIJify3BTzI5zsR2q86fwXrh74
    get_places:
      type: object
      properties:
        count:
          $ref: '#/components/schemas/count'
        url:
          type: string
          example: /v4/common/places
        data:
          $ref: '#/components/schemas/places'
        status:
          type: string
          enum:
            - OK
            - ZERO_RESULTS
            - OVER_QUERY_LIMIT
            - REQUEST_DENIED
            - INVALID_REQUEST
            - UNKNOWN_ERROR
    'places@{id}':
      type: object
      properties:
        city:
          type: string
          example: London
        state:
          type: string
          example: London
        country:
          type: string
          example: United Kingdom
        formatted_address:
          type: string
          example: '221 Baker St, Marylebone, London, United Kingdom'
        latitude:
          type: number
          example: 12.971599
        longitude:
          type: number
          example: 77.594566
    'get_places@{id}':
      type: object
      properties:
        url:
          type: string
          example: /v4/common/places
        data:
          $ref: '#/components/schemas/places@{id}'
    employee_id:
      type: string
      maxLength: 255
      description: >
        This id prodvided by Fyle to uniquely identify an employee within an
        organization.

        This id is always prefixed with `ou`.
      readOnly: true
      example: outGt9ju6qP
    employees:
      type: object
      description: Details of the employee to whom this object belongs to.
      readOnly: true
      properties:
        user_id:
          type: string
          maxLength: 255
          description: |
            This id helps to identify employees in other organisations.
            It is always prefixed with the string `us`.
            It is unique per email.
          example: usIYTLwzlaGu
        employee_code:
          type: string
          maxLength: 255
          example: E84122
          description: >
            This field refers to any string that the client programs can use to
            refer to an employee's unique id.

            This could be any field such as an UUID from an Active Directory
            server or employee id in a HRMS system.
        location:
          type: string
          maxLength: 255
          example: Bangalore Ofc
        level_id:
          type: string
          maxLength: 255
          example: lvlnvJUe9k6Vx
        department_id:
          type: string
          maxLength: 255
          example: dept9in4oIHpdR
        business_unit:
          type: string
          maxLength: 255
          example: Finance ops
          description: >-
            Represents the business unit of the organization to which of the
            employee belongs.
        title:
          type: string
          maxLength: 255
          example: Branch Manager
          description: Represents the title/desgination of the employee.
        mobile:
          type: string
          description: >
            Mobile number of the employee.

            `Given example is a fake number. We don't know who might answer your
            call.`
          example: +1-202-555-0167
        joining_dt:
          type: string
          format: date
          example: '2018-10-31'
          description: Date string in YYYY-MM-DD format
        full_name:
          type: string
          maxLength: 255
          example: John Doe
          description: >-
            Represents the full name of the employee. Must be at least 3
            characters.
    project:
      type: object
      properties:
        name:
          type: string
          maxLength: 255
          description: Represents the name of the project.
          example: Fast and Furious
        sub_project:
          type: string
          maxLength: 255
          description: Represents the name of the sub_project.
          example: Formula One
        display_name:
          type: string
          maxLength: 513
          description: >
            This is a combination of name and sub_project separated by a / and
            spaces.

            In case if no sub_project is present it is same as name of the
            project.
          example: Fast and Furious / Formula One
        code:
          type: string
          maxLength: 255
          description: |
            This represents the code of project.
          example: FF-032
    cost_center:
      type: object
      readOnly: true
      properties:
        id:
          type: string
          example: '11539'
        name:
          type: string
          maxLength: 255
          example: sales & marketing
        code:
          type: string
          example: sm-cc
    category:
      type: object
      properties:
        id:
          type: string
          maxLength: 10
          example: '16570'
          description: >
            This id provided by Fyle to identify a category from this
            organisation.

            This id is a numeric string.

            This id is unique within the organisation.
        name:
          type: string
          maxLength: 255
          example: Engine
          description: Represents the name of the category.
        sub_category:
          type: string
          maxLength: 255
          example: Turbo charged
          description: Represents the name of the sub_category.
        display_name:
          type: string
          maxLength: 255
          example: Engine / Turbo charged
          description: >
            This is a combination of name and sub_category separated by a / and
            spaces.

            In case if no sub_category is present it is same as name of the
            category.
        system_category:
          type: string
          maxLength: 255
          example: Others
          description: Represents the name of the system_category.
    created_at:
      type: string
      format: date-time
      description: >
        <a href='https://tools.ietf.org/html/rfc3339#section-5.6'>RFC 3339,
        section 5.6 compliant timestamp.</a>

        Signifies when this object was created.
      readOnly: true
      example: '2020-06-01T13:14:54.804Z'
    updated_at:
      type: string
      format: date-time
      description: >
        <a href='https://tools.ietf.org/html/rfc3339#section-5.6'>RFC 3339,
        section 5.6 compliant timestamp.</a>

        Signifies when this object was updated.
      readOnly: true
      example: '2020-06-11T13:14:55.201598Z'
    report:
      type: object
      readOnly: true
      properties:
        purpose:
          type: string
        approved_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp on which the Report was approved.

            This field could be null if the Report was not yet approved.
          example: '2020-07-23T09:32:00.933Z'
        reimbursed_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp on which the Expense was Reimbursed.

            If the Expense is not reimbursed yet, this could be null. <br>
          example: '2020-07-28T09:32:00.933Z'
        claim_number:
          type: string
          maxLength: 255
        settlement_id:
          type: string
          maxLength: 255
          description: >
            An unique ID, generated by Fyle, for identifying the Settlement.

            Once a Report is paid, the value of this field cannot be changed and
            is immutable. <br>
          example: setzS7mbPKPWg
        settled_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp on which the report approved was settled. <br>
          example: '2020-07-23T09:32:00.933Z'
        trip_request_id:
          type: string
          description: An ID of the TripRequest associated with it
    location:
      type: object
      properties:
        city:
          type: string
          example: London
        state:
          type: string
          example: London
        display_name:
          type: string
        country:
          type: string
          example: United Kingdom
        formatted_address:
          type: string
          example: '221 Baker St, Marylebone, London, United Kingdom'
        latitude:
          type: number
          example: 12.971599
        longitude:
          type: number
          example: 77.594566
    perdiem:
      type: object
      readOnly: true
      properties:
        id:
          type: string
          example: '1104'
        name:
          type: string
          maxLength: 255
          example: sales & marketing
        currency:
          type: string
          maxLength: 3
          example: USD
        rate:
          type: integer
          example: 40
    file:
      type: object
      readOnly: true
      properties:
        id:
          type: string
          description: |
            Id of the file object. Always starts with `fi`.
          example: figo4lgkn2224
        name:
          type: string
          description: |
            Name of the uploaded file.
          example: uber_expenses_vmrpw.pdf
        type:
          type: string
          enum:
            - THUMBNAILx200x200
            - ORIGINAL
            - ENCRYPTED
          description: >
            Indicates whether this file original size or encrypted or its
            thumbnail image.
          example: ORIGINAL
        password:
          type: string
          description: |
            Password which required to unlock the file.
          example: SuperSecretPassword
        download_path:
          type: string
          description: |
            Link to download this file.
            change this to right url later.
          example: /api/files/fiGxWO1vdkW8/download
    custom_properties:
      type: object
      additionalProperties:
        oneOf:
          - type: string
          - type: boolean
          - type: integer
          - $ref: '#/components/schemas/location'
          - type: array
            items:
              type: string
        description: >
          The value for the custom properties. This could be a String, Boolean,
          Integer or an Array of Strings. <br>
      example:
        house: gryffindor
    approvals:
      type: object
      description: |
        siginifies all the approvals of a particular object.
      additionalProperties:
        type: object
        properties:
          state:
            type: string
            enum:
              - APPROVED
              - APPROVAL_PENDING
              - APPROVAL_DISABLED
      example:
        oueoblnegf:
          state: APPROVED
    org_id:
      type: string
      description: |
        The unique id of the Organization to which the object is associated.
      example: orwruogwnngg
    org_name:
      type: string
      description: |
        The Name of the Organization to which the object is associated.
      example: Ministry of Magic
    expense_actions:
      type: object
      properties:
        id:
          type: string
          example: '1'
        can_approve:
          type: boolean
          example: true
        can_delete:
          type: boolean
          example: false
        can_edit:
          type: boolean
          example: true
        can_manual_flag:
          type: boolean
          example: false
        can_add_approver:
          type: boolean
          example: true
        can_assign:
          type: boolean
          example: false
        can_verify:
          type: boolean
          example: true
        can_admin_approve:
          type: boolean
          example: false
        can_edit_physical_bill:
          type: boolean
          example: true
        can_remove_from_report:
          type: boolean
          example: false
    expenses:
      type: object
      properties:
        id:
          type: string
          maxLength: 255
          example: tx12345
          description: >-
            An unique string to identify the Expense. Ignore this field when
            used as part of a POST request to create an Expense.
          readOnly: true
        employee_email:
          type: string
          maxLength: 127
          format: email
          description: >
            Email address of the Employee for whom the expense was/will-be
            created. Once an Expense is created, the value of this field cannot
            be changed and is immutable. <br>
          example: john.doe@example.com
        employee_id:
          $ref: '#/components/schemas/employee_id'
        employee:
          $ref: '#/components/schemas/employees'
        spent_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp on which the transaction for which the expense [being]
            fyled was made. <br>

            This date cannot be in future.
          example: '2020-07-21T17:32:28Z'
        source:
          type: string
          example: SLACK_APP
          description: >
            The name of the client app which is creating the expense.

            if its a thrid party app, it prefixed with TPA_.

            Ex - If you pass SLACK_APP, it will be saved as TPA_SLACK_APP. If
            not passed, source is saved as TPA.
        currency:
          type: string
          maxLength: 3
          example: USD
          description: >
            ISO 4217 currency codes that are usually of three upper case
            letters.

            See "https://www.iban.com/currency-codes" for examples.

            If this field is ignored during a POST call to create/update an
            Expense, the default currency of the organization will be used.

            To use other currency than default currency use `foreign_currency`
            field.
        amount:
          type: number
          description: >
            The transaction amount for which the expense was/will-be fyled.

            The amount will be in the currency that the organization is setup
            with in case of GET requests. <br>

            Note that, when used as part of creating an Expense via POST, the
            actual amount in the Expense, in a subsequent GET call, may get
            changed either because of policies or admin/approvers changing the
            amount.
          example: 1500
        user_amount:
          type: number
          description: >
            The transaction amount as claimed by user.

            The amount will be in the currency that the organization is setup
            with in case of GET requests. <br>
          example: 1984.18
        policy_amount:
          type: number
          description: >
            The transaction amount which is modified by policy.

            The amount will be in the currency that the organization is setup
            with in case of GET requests. <br>
          example: 1500
        admin_amount:
          type: number
          description: >
            The transaction amount which is modified by admin or approver.

            The amount will be in the currency that the organization is setup
            with in case of GET requests. <br>

            This could be null if admin or approver has not edited your expense.
          example: null
        tax:
          type: number
          description: Tax amount as setup by your organisation.
          deprecated: true
        foreign_currency:
          type: string
          maxLength: 3
          example: INR
          description: >
            ISO 4217 currency codes that are usually of three upper case
            letters.

            See "https://www.iban.com/currency-codes" for examples.

            This field is used when expense is of non-default currency of an
            organisation.
        foreign_amount:
          type: number
          description: >
            The transaction foriegn amount for which the expense was/will-be
            fyled.

            The amount will be in the currency that is mentioned in the `foriegn
            currncy`<br>

            Note that, if an expense of currency other default currency of an
            organistation is used then `amount`, `foreign_currency`,
            `foreign_amount` are mandatory.
          example: 138962.05
        created_by:
          type: string
          maxLength: 255
          description: >
            An unique ID, generated by Fyle, for identifying the Employee who
            created the expense. Once an Expense is created, the value of this
            field cannot be changed and is immutable. <br>
          example: ou12345Zdfx
          readOnly: true
        purpose:
          type: string
          maxLength: 1024
          description: Justification for the expense.
          example: Team lunch
        project_id:
          type: string
          description: >
            The ID generated by Fyle to uniquely identify the Project, to which
            the Expense belongs. <br>
          example: '1234'
        project:
          $ref: '#/components/schemas/project'
        cost_center_id:
          type: string
          description: >
            The ID generated by Fyle to uniquely identify the CostCenter, to
            which the Expense belongs. <br>
          example: '4321'
        cost_centers:
          $ref: '#/components/schemas/cost_center'
        category_id:
          type: string
          description: >
            The unique ID of a Category to which the Expense belongs. <br>

            Use `GET /api/tpa/v1/categories` to get the list of valid ID and
            Name of the Categories for the organization.
          example: '18'
        category:
          $ref: '#/components/schemas/category'
        state:
          type: string
          enum:
            - COMPLETE
            - DRAFT
            - PAID
            - PAYMENT_PROCESSING
            - APPROVER_PENDING
            - PAYMENT_PENDING
            - APPROVED
          description: >-
            The state of the Expense. This field shall be ignored in POST calls
            when creating/updating an Expense.
          readOnly: true
        fund_source:
          type: string
          enum:
            - PERSONAL
            - ADVANCE
            - CCC
          description: >-
            The fund source of the Expense. This field shall be ignored in POST
            calls when creating/updating an Expense.
          readOnly: true
        payment_id:
          type: string
        source_account_id:
          type: string
        source_account_type:
          type: string
        invoice_number:
          type: string
          description: |
            invoice number from the receipt.
        billable:
          type: boolean
          example: true
          description: This fields marks whether a given expense is billable a not.
        reimbursable:
          type: boolean
          example: true
        created_at:
          $ref: '#/components/schemas/created_at'
        updated_at:
          $ref: '#/components/schemas/updated_at'
        expense_number:
          type: string
          description: |
            This is user visible identifier for an expense.
            This field can be used as reference in UI.
          example: E/2020/10/T/95
        exchange_rate:
          type: number
          description: >
            This field determines at which rate the expenses from foriegn
            currency was converted to home curreny
        report_id:
          type: string
          description: |
            Unique id given by Fyle to identify an Expense Report.
        reported_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp on which the Expense was submitted via a Report to the
            Approvers.

            If the Expense is not added to a Report yet or if the Report is not
            yet submitted, this could be null.
        report:
          $ref: '#/components/schemas/report'
        physical_bill:
          type: boolean
          description: |
            This field indicated whether physicall bill was received or not.
          example: true
        physical_bill_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp indicating when the Expense's physicall bill was
            submitted.

            If the Expense's bill is not required to be submitted, then this
            could be null.
        verified:
          type: boolean
          description: |
            Indicates whether the Expense is verified or not
          readOnly: true
        verification_state:
          type: string
        verified_at:
          type: string
          format: date-time
          description: >
            RFC 3339, section 5.6
            "https://tools.ietf.org/html/rfc3339#section-5.6" compliant
            timestamp on which the Expense was verified.

            If the Expense is not verified yet, this could be null. <br>
          readOnly: true
        skip_reimbursement:
          type: boolean
          deprecated: true
        vendor:
          type: string
          example: Uber
          maxLength: 255
          description: |
            String denoting the name of the vendor to which the Expense was made
        vendor_id:
          type: string
          example: 24242r
          maxLength: 255
          description: |
            String denoting the id of the vendor to which the Expense was made
        locations:
          description: >
            This field will be present for travel related categories. To add to
            and from location to you travel category related expenses add two
            locations in schema given below.
          type: array
          items:
            $ref: '#/components/schemas/location'
        train_travel_class:
          description: |
            This field is applicable for only Train category.
          type: string
          example: string
        flight_journey_travel_class:
          description: >
            This field is applicable only for flight category. Can be
            `BUSINESS`, `ECONOMY`, `FIRST_CLASS`
          type: string
          example: ECONOMY
        flight_return_travel_class:
          description: >
            This field is applicable only for flight category. Can be
            `BUSINESS`, `ECONOMY`, `FIRST_CLASS`
          type: string
          example: BUSINESS
        bus_travel_class:
          description: |
            This field is applicable only for bus category.
          type: string
          example: AC
        from_dt:
          description: >
            This field is only relevant for travel related categories. This
            represents the onward date.
          type: string
          example: '2019-07-17T00:00:00.000Z'
        to_dt:
          description: >
            This field is only relevant for travel related categories. This
            represents the return date.
          type: string
          example: '2019-07-27T00:00:00.000Z'
        distance:
          type: number
        distance_unit:
          type: string
        num_days:
          type: integer
        mileage_calculated_distance:
          type: number
        mileage_calculated_amount:
          type: number
        mileage_vehicle_type:
          type: string
        mileage_rate:
          type: number
        mileage_is_round_trip:
          type: boolean
        hotel_is_breakfast_provided:
          type: boolean
        per_diem_rate_id:
          type: string
        per_diem_rate:
          $ref: '#/components/schemas/perdiem'
        activity_details:
          type: string
        activity_policy_pending:
          type: boolean
        num_files:
          type: integer
          description: |
            Number of files attached to this Expenses.
        has_attachments:
          type: boolean
          description: >
            Returns if there are file attachments that the Expense has. Usually
            the image of the receipts are added as attachments to the Expenses.
          readOnly: true
        attachments:
          description: >
            Returns expense attachments. <br>

            This field will not be present in the response for the GET method on
            the `/api/tpa/v1/expenses` call.
          type: array
          items:
            $ref: '#/components/schemas/file'
        custom_properties:
          $ref: '#/components/schemas/custom_properties'
        user_can_delete:
          type: boolean
          description: >
            This field describes whether a user can delete this expenses.

            This is flag is set as false when travel agent creates expenses on
            your behalf.
          example: true
        policy_flag:
          type: boolean
          description: >-
            This field indicates whether policy execution has flagged this
            expenses or not.
          example: false
        manual_flag:
          type: boolean
          description: >
            This field indicates whether this expenses was manually flagged by
            approver or finance or admin.
          example: true
        policy_state:
          type: string
          enum:
            - FAILED
            - SUCCESS
            - RUNNING
          description: >
            This fields shows policy execution state for this expenses.

            If this field is null then its policy has not yet run on this
            expenses.
        extracted_data:
          type: object
        transcribed_data:
          type: object
        user_review_needed:
          type: boolean
        mandatory_fields_present:
          type: boolean
        transcription_state:
          type: string
          enum:
            - IN_PROGRESS
            - SUCCESS
            - FAILURE
            - NO_WORK
          example: SUCCESS
        receipt_required:
          type: boolean
        is_holiday_expense:
          type: boolean
        risk_state:
          type: string
          enum:
            - HIGH_RISK
            - MODERATE_RISK
            - NO_RISK
          example: NO_RISK
        external_id:
          type: string
        split_group_id:
          type: string
        split_group_user_amount:
          type: string
        external_expense:
          type: object
        corporate_credit_card_transaction:
          type: object
        transaction_approvals:
          allOf:
            - $ref: '#/components/schemas/approvals'
          example:
            ougelgneget:
              state: APPROVED
            ougo3nlwfgg:
              state: APPROVAL_PENDING
        org_id:
          $ref: '#/components/schemas/org_id'
        org_name:
          $ref: '#/components/schemas/org_name'
        actions:
          $ref: '#/components/schemas/expense_actions'
    vision_audit:
      type: object
      properties:
        data:
          type: object
          properties:
            entered_data:
              $ref: '#/components/schemas/expenses'
            external_id:
              type: string
              description: |
                The external id generated after creating the expense.
      required:
        - data
    bulk_error:
      type: object
      properties:
        row:
          type: integer
          description: |
            This holds the info of which row contains bad data.
        key:
          type: string
          description: |
            This helps in identifying the error by unique key.
        message:
          type: string
          description: |
            This explains what the error is in `human readable` text.
    json_parsing_error:
      type: object
      properties:
        message:
          enum:
            - Unable to process JSON
          type: string
          description: |
            This error means that incoming json is not in right format.
        code:
          type: integer
          default: 400
          example: 400
          deprecated: true
    vision_extract:
      type: object
      properties:
        data:
          type: object
          properties:
            client:
              type: string
              maxLength: 255
              description: |
                Takes the platform name from where this API is requested.
              example: WEBAPP
            files:
              type: array
              items:
                type: object
                properties:
                  name:
                    type: string
                    maxLength: 255
                    description: |
                      Takes the name of the file which contains the receipt.
                  content:
                    type: string
                    description: >
                      This field takes the base64 encoded representation of the
                      file.
                    example: JVBERi0xLjQKMSAwIG9iago8PAovVGl0bGUgKP7/KQovQ3JlYX...
            meta:
              type: object
              description: |
                Additional optional data.
              properties:
                sender_email:
                  type: string
                expense_date:
                  type: string
      required:
        - data
    objects_vision_extract:
      type: object
      properties:
        data:
          type: object
          properties:
            callback_url:
              type: string
              description: |
                Contains the callback url for auditing.
              example: 'https://platform.fylehq.com/v1/vision_audit/aud8Ydg78GOh'
            amount:
              type: number
              description: |
                Extracted expense amount from receipt.
              example: 1500
            category_name:
              type: string
              maxLength: 25
              description: |
                Extracted category of expense from receipt.
              example: Flight
            currency:
              type: string
              maxLength: 3
              example: USD
              description: >
                Extracted currency from the given receipt. <br>

                ISO 4217 currency codes that are usually of three upper case
                letters.

                See "https://www.iban.com/currency-codes" for examples.
            date:
              $ref: '#/components/schemas/created_at'
            invoice_dt:
              type: string
              format: date-time
              description: >
                RFC 3339, section 5.6
                "https://tools.ietf.org/html/rfc3339#section-5.6" compliant 

                Extracted timestamp on which the Expense was made.
            vendor_name:
              type: string
              example: Uber
              maxLength: 255
              description: >
                Extracted string denoting the name of the vendor to which the
                expense was made
            source:
              type: string
              example: ROBOT
              description: |
                The name of the client which is extracting the data.
    post_vision_extract:
      type: object
      properties:
        count:
          $ref: '#/components/schemas/count'
        url:
          type: string
          example: /v4/common/vision_extract
        data:
          $ref: '#/components/schemas/objects_vision_extract'
tags:
  - name: Places
    description: |
      These APIs gives the places suggestions and geographic data of a place.
  - name: Data Extraction
    description: |
      These APIs gives the expense relevant data from the reciepts
paths:
  /common/places:
    get:
      tags:
        - Places
      summary: List places
      description: |
        Lists all the place suggestions based on given query.
      operationId: GetPlacesAutocomplete
      parameters:
        - $ref: '#/components/parameters/text'
        - $ref: '#/components/parameters/types'
        - $ref: '#/components/parameters/cordinates'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/get_places'
        '401':
          description: Unauthorized request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/401'
  '/common/places/{id}':
    get:
      tags:
        - Places
      summary: Retrieve geographic data
      description: |
        Gives the exact geographic data for the given place id.
      operationId: GetPlacesGeocode
      parameters:
        - in: path
          name: id
          required: true
          description: >
            It contains a textual identifier that uniquely identifies a
            place.<br>

            place_id=ChIJify3BTzI5zsR2q86fwXrh74
          schema:
            type: string
            example: ChIJify3BTzI5zsR2q86fwXrh74
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/get_places@{id}'
  '/common/vision_audit/{id}':
    post:
      tags:
        - Data Extraction
      summary: Create or Update audit
      description: |
        Create or Update audit made on extracted data from a receipt.
      operationId: PostVisionAudit
      parameters:
        - in: path
          name: id
          required: true
          description: >
            It contains the audit id which can be found in Vision extract
            response as a `callback_url`.<br>

            id=audut94r4krk
          schema:
            type: string
            example: audut94r4krk
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/vision_audit'
      responses:
        '200':
          description: OK
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/bulk_error'
                    example:
                      - row: 1
                        key: Cost center abcd
                        message: Invalid or duplicate cost center code
                  - $ref: '#/components/schemas/json_parsing_error'
        '401':
          description: Unauthorised request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/401'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/403'
  /common/vision_extract:
    post:
      tags:
        - Data Extraction
      summary: Retrieve expense data from receipt
      description: |
        Retrieve expense related data from the given receipt.
      operationId: PostVisionExtract
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/vision_extract'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    example: /v4/common/vision_extract
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/post_vision_extract'
        '400':
          description: Bad request
          content:
            application/json:
              schema:
                oneOf:
                  - type: array
                    items:
                      $ref: '#/components/schemas/bulk_error'
                    example:
                      - row: 1
                        key: Cost center abcd
                        message: Invalid or duplicate cost center code
                  - $ref: '#/components/schemas/json_parsing_error'
        '401':
          description: Unauthorised request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/401'
        '403':
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/403'
